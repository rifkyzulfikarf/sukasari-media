<?php

//include 'config.php';

//eval(base64_decode(" Y2xhc3Mga29uZWtzaSB7ICAgcHVibGljICRrb25lazsgICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCl7ICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+a29uZWs9bmV3IG15c3FsaShEQVRBX0hPU1QsIERBVEFfVVNFUiwgREFUQV9QQVNTLCBEQVRBX0JBU0UpOyAgICAgICAgICAgICAgaWYoJHRoaXMtPmtvbmVrLT5jb25uZWN0X2Vycm5vKXsgICAgICAgICAgICAgZWNobyAnVW5hYmxlIHRvIGNvbm5lY3QgdG8gZGF0YWJhc2UgWycgLiAkdGhpcy0+a29uZWstPmNvbm5lY3RfZXJyb3IgLiAnXSc7ICAgICAgICAgICAgIGV4aXQoKTsgICAgICAgICB9ICAgICAgICAgIH0gICAgICBwdWJsaWMgZnVuY3Rpb24gY29tbWl0KCl7ICAgICAgICAgJHRoaXMtPmtvbmVrLT5jb21taXQoKTsgICAgIH0gICAgICAgICAgcHVibGljIGZ1bmN0aW9uIGF1dG9jb21taXQoJGFwYSl7ICAgICAgICAgJHRoaXMtPmtvbmVrLT5hdXRvY29tbWl0KCRhcGEpOyAgICAgfSAgICAgIHB1YmxpYyBmdW5jdGlvbiByb2xsYmFjaygpeyAgICAgICAgICR0aGlzLT5rb25lay0+cm9sbGJhY2soKTsgICAgIH0gICAgICBmdW5jdGlvbiBfX2Rlc3RydWN0KCl7ICAgICAgICAgICAgICB9ICAgICAgICAgIGZ1bmN0aW9uIGNsb3NlREIoKXsgICAgICAgICAkdGhpcy0+a29uZWstPmNsb3NlKCk7ICAgICB9ICAgICAgICAgIHB1YmxpYyBmdW5jdGlvbiBjbGVhclRleHQoJHRleHQpIHsgICAgICAgICAkdGV4dCA9IHRyaW0oJHRleHQpOyAgICAgICAgIHJldHVybiAkdGhpcy0+a29uZWstPnJlYWxfZXNjYXBlX3N0cmluZygkdGV4dCk7ICAgICB9ICAgICAgICBwdWJsaWMgZnVuY3Rpb24gbGFzdEluc2VydElEKCkgeyAgICAgICAgIHJldHVybiAkdGhpcy0+a29uZWstPmluc2VydF9pZDsgICAgIH0gICAgICAgcHVibGljIGZ1bmN0aW9uIHJ1blF1ZXJ5KCRxcnkpIHsgICAgICAgICAkcmVzdWx0ID0gJHRoaXMtPmtvbmVrLT5xdWVyeSgkcXJ5KTsgICAgICAgICByZXR1cm4gJHJlc3VsdDsgICAgIH0gICAgICAgICAgIHB1YmxpYyBmdW5jdGlvbiBydW5NdWx0aXBsZVF1ZXJpZXMoJHFyeSkgeyAgICAgICAgICRyZXN1bHQgPSAkdGhpcy0+a29uZWstPm11bHRpX3F1ZXJ5KCRxcnkpOyAgICAgICAgIHJldHVybiAkcmVzdWx0OyAgICAgfSAgICAgICAgIHB1YmxpYyBmdW5jdGlvbiB0b3RhbENvdW50KCRmaWVsZG5hbWUsICR0YWJsZW5hbWUsICR3aGVyZSA9ICIiKXsgICAgICAgICAkcSA9ICJTRUxFQ1QgY291bnQoIi4kZmllbGRuYW1lLiIpIEZST00gIiAgICAgICAgIC4gJHRhYmxlbmFtZSAuICIgIiAuICR3aGVyZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gJHRoaXMtPmtvbmVrLT5xdWVyeSgkcSk7ICAgICAgICAgJGNvdW50ID0gMDsgICAgICAgICBpZiAoJHJlc3VsdCkgeyAgICAgICAgICAgICB3aGlsZSAoJHJvdyA9IG15c3FsaV9mZXRjaF9hcnJheSgkcmVzdWx0KSkgeyAgICAgICAgICAgICAgICAgJGNvdW50ID0gJHJvd1swXTsgICAgICAgICAgICAgfSAgICAgICAgIH0gICAgICAgIHJldHVybiAkY291bnQ7ICAgICB9ICAgICAgICAgIHB1YmxpYyBmdW5jdGlvbiBvbm9QaXJvKCRmaWVsZG5hbWUsICR0YWJsZW5hbWUsICR3aGVyZSA9ICIiKXsgICAgICAgICAkcSA9ICJTRUxFQ1QgY291bnQoIi4kZmllbGRuYW1lLiIpIGFzIGptbCBGUk9NICIgICAgICAgICAuICR0YWJsZW5hbWUgLiAiICIgLiAkd2hlcmU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICR0aGlzLT5rb25lay0+cXVlcnkoJHEpOyAgICAgICAgICRycz0kcmVzdWx0LT5mZXRjaF9hcnJheSgpOyAgICAgICAgICAgICAgICAgIHJldHVybiAkcnNbImptbCJdOyAgICAgfSAgICAgICAgICAgIH0gICAgICAgICAgICAgIGZ1bmN0aW9uIGVuY3J5cHRfZGVjcnlwdCgkYWN0aW9uLCAkc3RyaW5nICkgeyAgICAgICAgICAgICAgICAgaWYoICRhY3Rpb24gPT0gJ2VuY3J5cHQnICkgeyAgICAgICAgICAgICAgICAgICRvdXRwdXQgPSBiYXNlNjRfZW5jb2RlKCRzdHJpbmcpOyAgICAgfSAgICAgZWxzZSBpZiggJGFjdGlvbiA9PSAnZGVjcnlwdCcgKXsgICAgICAgICAkb3V0cHV0ID0gYmFzZTY0X2RlY29kZSgkc3RyaW5nKTsgICAgIH0gICAgICByZXR1cm4gJG91dHB1dDsgfSAgZnVuY3Rpb24gZV91cmwoICR1cmwgKXsgICAgICAkb3V0cHV0PWh0bWxzcGVjaWFsY2hhcnMoIGVuY3J5cHRfZGVjcnlwdCgnZW5jcnlwdCcsICR1cmwgKSApOyAgICAgcmV0dXJuICRvdXRwdXQ7IH0gIGZ1bmN0aW9uIGRfdXJsKCAkdXJsICl7ICAgICAkb3V0cHV0PWh0bWxzcGVjaWFsY2hhcnMoIGVuY3J5cHRfZGVjcnlwdCgnZGVjcnlwdCcsICR1cmwgKSApOyAgICAgcmV0dXJuICRvdXRwdXQ7ICB9ICBmdW5jdGlvbiBlX2NvZGUoICRzdHJpbmcgKXsgICAgICAkb3V0cHV0PWh0bWxzcGVjaWFsY2hhcnMoIGVuY3J5cHRfZGVjcnlwdCgnZW5jcnlwdCcsICRzdHJpbmcgKSApOyAgICAgcmV0dXJuICRvdXRwdXQ7IH0gIGZ1bmN0aW9uIGRfY29kZSggJHN0cmluZyApeyAgICAgJG91dHB1dD1odG1sc3BlY2lhbGNoYXJzKCBlbmNyeXB0X2RlY3J5cHQoJ2RlY3J5cHQnLCAkc3RyaW5nICkgKTsgICAgIHJldHVybiAkb3V0cHV0OyAgfSAgICAgIGZ1bmN0aW9uIGNla19sb2dpbigkdXNlciwkcGFzcyl7ICAgICRrb25la3NpID0gbmV3IGtvbmVrc2koKTsgICAgICR1c2VyID0gZV9jb2RlKCR1c2VyKTsgICAgJHBhc3MgPSBlX2NvZGUoJHBhc3MpOyAgICAgIGlmKCAkaG1tID0gJGtvbmVrc2ktPnJ1blF1ZXJ5KCJTRUxFQ1QgYHBlbWFrYWlgLiosIGBrYXJ5YXdhbmAuYGlkYCBhcyBgaWRfa2FyYCwgYGthcnlhd2FuYC5gbGV2ZWxgLCBga2FyeWF3YW5gLmBhcmVhYCAgRlJPTSBgcGVtYWthaWAgTEVGVCBPVVRFUiBKT0lOIGBrYXJ5YXdhbmAgT04gYGthcnlhd2FuYC5gaWRgID0gYHBlbWFrYWlgLmBpZF9rYXJ5YXdhbmAgV0hFUkUgYHBlbWFrYWlgLmB1c2VyYD0nJHVzZXInICYmIGBwZW1ha2FpYC5ga3VuY2lgPSckcGFzcycgIikgKXsgICAgICAgaWYoICRobW0tPm51bV9yb3dzID4gMCApeyAgICAgICAgICAgICAgICAgICAkcnM9JGhtbS0+ZmV0Y2hfYXJyYXkoKTsgICAgICAgICAgICAgICAgICAgIGlmKCAkcnNbJ3N0YXR1cyddPD5lX2NvZGUoJzk5JykgKXsgICAgICAgICAgICAgJGxvZz0ka29uZWtzaS0+cnVuUXVlcnkoIklOU0VSVCBJTlRPIGBsb2dfbG9naW5gKGBpZF91c2VyYCxgdGltZWApIFZBTFVFUyAoJyIuJHJzWydpZCddLiInLCAnIi5kYXRlKCJZLW0tZCBIOmk6cyIpLiInKSIpOyAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAkX1NFU1NJT05bJ21lZGlhLWRhdGEnXT1lX2NvZGUoJHJzWydpZCddKTsgICAgICAgICAgJF9TRVNTSU9OWydtZWRpYS1uYW1hJ109ZF9jb2RlKCRyc1snbmFtYSddKTsgICAgICAgICAgJF9TRVNTSU9OWydtZWRpYS1zdGF0dXMnXT0kcnNbJ3N0YXR1cyddOyAgICAgICAgICAgaWYoIGlzX251bGwoJHJzWydpZF9rYXInXSkgKXsgICAgICAgICAgICAgJF9TRVNTSU9OWydtZWRpYS1pZCddID0gIiUiOyAgICAgICAgICAgICAkX1NFU1NJT05bJ21lZGlhLWxldmVsJ10gPSAiJSI7ICAgICAgICAgICAgICRfU0VTU0lPTlsnbWVkaWEtYXJlYSddID0gIiUiOyAgICAgICAgICB9ZWxzZXsgICAgICAgICAgICAgJF9TRVNTSU9OWydtZWRpYS1pZCddID0gJHJzWydpZF9rYXInXTsgICAgICAgICAgICAgJF9TRVNTSU9OWydtZWRpYS1sZXZlbCddID0gJHJzWydsZXZlbCddOyAgICAgICAgICAgICAkX1NFU1NJT05bJ21lZGlhLWFyZWEnXSA9ICRyc1snYXJlYSddOyAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRSVUU7ICAgICAgICB9ZWxzZXsgICAgICAgICAgcmV0dXJuIEZBTFNFOyAgICAgICAgIH0gICAgICB9ZWxzZXsgICAgICAgcmV0dXJuIEZBTFNFOyAgICAgfSB9"));


class koneksi {   public $konek;     function __construct(){                       $this->konek=new mysqli("localhost", "root", "", "sukasari_media");              if($this->konek->connect_errno){             echo 'Unable to connect to database [' . $this->konek->connect_error . ']';             exit();         }          }      public function commit(){         $this->konek->commit();     }          public function autocommit($apa){         $this->konek->autocommit($apa);     }      public function rollback(){         $this->konek->rollback();     }      function __destruct(){              }          function closeDB(){         $this->konek->close();     }          public function clearText($text) {         $text = trim($text);         return $this->konek->real_escape_string($text);     }        public function lastInsertID() {         return $this->konek->insert_id;     }       public function runQuery($qry) {         $result = $this->konek->query($qry);         return $result;     }           public function runMultipleQueries($qry) {         $result = $this->konek->multi_query($qry);         return $result;     }         public function totalCount($fieldname, $tablename, $where = ""){         $q = "SELECT count(".$fieldname.") FROM "         . $tablename . " " . $where;                           $result = $this->konek->query($q);         $count = 0;         if ($result) {             while ($row = mysqli_fetch_array($result)) {                 $count = $row[0];             }         }        return $count;     }          public function onoPiro($fieldname, $tablename, $where = ""){         $q = "SELECT count(".$fieldname.") as jml FROM "         . $tablename . " " . $where;                           $result = $this->konek->query($q);         $rs=$result->fetch_array();                  return $rs["jml"];     }            }              function encrypt_decrypt($action, $string ) {                 if( $action == 'encrypt' ) {                  $output = base64_encode($string);     }     else if( $action == 'decrypt' ){         $output = base64_decode($string);     }      return $output; }  function e_url( $url ){      $output=htmlspecialchars( encrypt_decrypt('encrypt', $url ) );     return $output; }  function d_url( $url ){     $output=htmlspecialchars( encrypt_decrypt('decrypt', $url ) );     return $output;  }  function e_code( $string ){      $output=htmlspecialchars( encrypt_decrypt('encrypt', $string ) );     return $output; }  function d_code( $string ){     $output=htmlspecialchars( encrypt_decrypt('decrypt', $string ) );     return $output;  }      function cek_login($user,$pass){    $koneksi = new koneksi();     $user = e_code($user);    $pass = e_code($pass);      if( $hmm = $koneksi->runQuery("SELECT `pemakai`.`id`,`pemakai`.`user`,`pemakai`.`kunci`,`pemakai`.`status`, `karyawan`.`nama` , `karyawan`.`id` as `id_kar`, `karyawan`.`level`, `karyawan`.`area`  FROM `pemakai` INNER JOIN `karyawan` ON `karyawan`.`id` = `pemakai`.`id_karyawan` WHERE `pemakai`.`user`='$user' && `pemakai`.`kunci`='$pass' ") ){       if( $hmm->num_rows > 0 ){                   $rs=$hmm->fetch_array();                    if( $rs['status']<>e_code('99') ){             $log=$koneksi->runQuery("INSERT INTO `log_login`(`id_user`,`time`) VALUES ('".$rs['id']."', '".date("Y-m-d H:i:s")."')");          }                    $_SESSION['media-data']=e_code($rs['id']);          $_SESSION['media-nama']=$rs['nama'];          $_SESSION['media-status']=$rs['status'];           if( is_null($rs['id_kar']) ){             $_SESSION['media-id'] = "%";             $_SESSION['media-level'] = "%";             $_SESSION['media-area'] = "%";          }else{             $_SESSION['media-id'] = $rs['id_kar'];             $_SESSION['media-level'] = $rs['level'];             $_SESSION['media-area'] = $rs['area'];          }                              return TRUE;        }else{          return FALSE;         }      }else{       return FALSE;     } }


?>